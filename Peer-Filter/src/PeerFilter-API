
                               Peer ID Filter API
--------------------------------------------------------------------------------------
unix> python  PeerFilter.py 《x月汇总》路径 《员工信息表》路径 《总表》路径
--------------------------------------------------------------------------------------
一、目的
该程序根据上月员工业绩数据、员工信息表、总数据库（dta）等数据库，筛选出下个月各区域推送的2组人员名单和她们的业绩数据。

二、所需文件
    上个月员工业绩数据《x月汇总》（excel，本科生整理）、《员工信息表》（excel，随时更新）、所有员工业绩总数据库《总表》（dta->excel，随时更新）

三、所需变量
    《总表》df3：      区域      部门      工号     岗位     姓名     点号合计(月) 销售业绩(月)   入职日期    工资年月(判断月份)  出勤  离职时间  部门YG  入职日期YG
                                        |        |
    《x月汇总》df1：   店名（区域+店名）     工号     岗位     姓名     点号合计     销售业绩        ???
                       |                |        |                                        |
    《员工信息表》df2： 二级部门   部门     员工号     岗位名称  姓名                            入职日期
                                                 |
     				     只需理疗师、专家、SPA师

四、生成文件
    《x月筛选人员》文件夹-13个区域excel文档-每个excel表格6个sheet，分别为：
         0-3个月  4-6个月  7-12个月  1年以上  老人组  老人组long
    
五、同龄组4个群体入职时间划分（现在：201X年Y月，'Y-i'表示Y的前i个月）
    0-3组     201X年Y-3月第1天  至  当天
    4-6组     201X年Y-6月第1天  至  201X年Y-4月最后1天
    7-12组    201X年Y-12月第1天 至  201X年Y-7月最后一天
    12+组     201X年Y-13月最后一天及之前（注意与老人组入职时间定义是不同的）

六、检查标准
    ?

七、步骤
    step 0: 预处理《总表.dta》（可选：去除非技师行，删除无关变量列），转化成excel格式
    step 1: 读取3个excel文档，转换成DataFrame格式，分别命名：df1(上月业绩)、df2(员工信息)、df3(总表）
    step 2: 预处理。保留3个df技师，以“员工号”为基准，为df1添加来自df2的“入职日期”和“区域”两列信息
    Step 3: 为df1技师生成一组固定随机数
    -------------------
    level 1 组1 同龄组名单
      在df1中，对每个区域进行如下操作：
          对前3个群体进行如下操作：
             a: 筛出所有理疗师，按业绩(销售业绩)从高到低排序，选出中间1/3人
             b: 对这1/3人按随机数从高到低排序，选出前5人                 // corner case：低于5人？ -> 理疗师低于15人
             c: 对专家和SPA师进行a操作，再进行b操作，但是选出前10人        // corner case：低于10人？-> 其他技师低于30人
             // 对于人员不足情况，将未选中的人，不够时从这里面选取
             // 如果（1/2-1/3）人仍旧不能满足差值，则
             d: 合并15人数据至新的df中，每人包含如下信息，并按随机数从大到小排序：
                        工号 岗位 姓名 点号合计 销售业绩  区域  店名  入职日期  随机数
          对12+组所有技师按业绩从高到低排序，选出中间1/3人，再按随机数从高到低排序，宣传前15人。最后进行d操作
          共生成4个群体的4个df，储存至该区域excel表前4个sheet
      共生产13个区域13个excel表格，每个表格目前包含4个sheet
    -------------------
    level 2 组2 老人组名单
	在df1中，对每个区域进行如下操作：
     	     a: 按业绩排序，选出前1/2人
             b: 按“入职日期”筛出初步id名单，入职时间范围：2017年12月1日至201x年Y-13个月最后一天（注意与同龄人12+组的区别）
             C: 以上述名单id为基准，筛出df3中这部分人，合并至新的df中，每人包含如下信息（n+1行）：
                        工号 姓名 岗位 入职日期 第n月工作（工资年月-入职日期） 出勤（月）  点号合计（月）  销售业绩（月） 工资年月
                将该df储存至该区域excel表第6个sheet，命名“老人组long”     // corner case：如何清除rehire员工？
             D: 对上述df，对剩余每个员工，选出第x月（上月）的“点号合计”和“销售业绩”，形成简化版df，包含如下信息，并按随机数从大到小排序：
    			工号 岗位 姓名 点号合计 销售业绩  区域  店名  入职日期  随机数
                将新的df存储至该区域excel表第5个sheet，命名”老人组“。统计该sheet总人数。
        共生成13个区域13个excel表格的第5、第6个sheet。
        corner case：检查每个区域老人组人数，若某区域人数低于15人，从业绩相近且人数充足区域老人组补充。 // 是15人吗？补充的人可以重复推送吗？

八、注意事项
   1.处理corner cases ✅
   2.进行数据统计 ✅
   3.注意入职时间应该从维护表中选取
   4.注意总表筛选技师的方式，一定要先取反，因为有些员工原来是技师，但是后来改变职务了。另外总表中还有许多员工缺失id值，要想办法补全。
     （id缺失的员工在总表中几乎所有条目都缺失，先搁置）
   5.是否需要以及如何判断老人组rehire员工？
   6.老人组不足时，如何从业绩相近区域借取？以及如何判断业绩相近？















